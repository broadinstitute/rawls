<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog logicalFilePath="dummy" xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">
    <changeSet logicalFilePath="dummy" author="ehigham" id="add TRANSFER_IAM_CONFIGURED to V1_WORKSPACE_MIGRATION_HISTORY">
        <addColumn tableName="V1_WORKSPACE_MIGRATION_HISTORY">
            <column name="WORKSPACE_BUCKET_TRANSFER_IAM_CONFIGURED"
                    type="DATETIME"
                    afterColumn="TMP_BUCKET_CREATED">
                <constraints nullable="true"/>
            </column>
        </addColumn>
        <addColumn tableName="V1_WORKSPACE_MIGRATION_HISTORY">
            <column name="TMP_BUCKET_TRANSFER_IAM_CONFIGURED"
                    type="DATETIME"
                    afterColumn="FINAL_BUCKET_CREATED">
                <constraints nullable="true"/>
            </column>
        </addColumn>
    </changeSet>
    <changeSet logicalFilePath="dummy" author="ehigham" id="WORKSPACE_BUCKET_TRANSFER_IAM_CONFIGURED default value">
        <sql>
            update V1_WORKSPACE_MIGRATION_HISTORY
            set WORKSPACE_BUCKET_TRANSFER_IAM_CONFIGURED = WORKSPACE_BUCKET_TRANSFER_JOB_ISSUED;
        </sql>
    </changeSet>
    <changeSet logicalFilePath="dummy" author="ehigham" id="TMP_BUCKET_TRANSFER_IAM_CONFIGURED default value">
        <sql>
            update V1_WORKSPACE_MIGRATION_HISTORY
            set TMP_BUCKET_TRANSFER_IAM_CONFIGURED = TMP_BUCKET_TRANSFER_JOB_ISSUED;
        </sql>
    </changeSet>
</databaseChangeLog>
