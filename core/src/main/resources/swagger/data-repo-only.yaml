

paths:
  '/api/workspaces/{namespace}/{name}/snapshots':
    post:
      responses:
        '201':
          description: Created
          schema:
            $ref: '#/definitions/DataRepoSnapshotReference'
        '404':
          description: Workspace or snapshot not found
          schema:
            $ref: '#/definitions/ErrorReport'
        '500':
          description: Rawls Internal Error
          schema:
            $ref: '#/definitions/ErrorReport'
      description: "Add a reference to a snapshot in the Terra Data Repo"
      tags:
        - snapshots
      summary: Create a snapshot
      operationId: createDataRepoSnapshot
      parameters:
        - in: path
          description: The workspace namespace
          name: namespace
          required: true
          type: string
        - in: path
          description: The workspace name
          name: name
          required: true
          type: string
        - in: body
          description: Reference to the Data Repo snapshot
          name: dataRepoSnapshot
          required: true
          schema:
            $ref: '#/definitions/DataRepoSnapshot'
    get:
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/DataRepoSnapshotList'
        '404':
          description: Workspace not found or user lacks permissions
          schema:
            $ref: '#/definitions/ErrorReport'
        '500':
          description: Rawls Internal Error
          schema:
            $ref: '#/definitions/ErrorReport'
      description: "Enumerate references to snapshots in the Terra Data Repo"
      tags:
      - snapshots
      summary: List snapshots
      operationId: enumerateDataRepoSnapshot
      parameters:
      - in: path
        description: The workspace namespace
        name: namespace
        required: true
        type: string
      - in: path
        description: The workspace name
        name: name
        required: true
        type: string
      - in: query
        name: offset
        description: The number of items to skip before starting to collect the result set.
        type: int
        required: true
      - in: query
        name: limit
        description: The number of items to return.
        type: int
        required: true

  '/api/workspaces/{namespace}/{name}/snapshots/{snapshotId}':
    get:
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/DataRepoSnapshotReference'
        '404':
          description: Workspace or snapshot not found
          schema:
            $ref: '#/definitions/ErrorReport'
        '500':
          description: Rawls Internal Error
          schema:
            $ref: '#/definitions/ErrorReport'
      description: "Get a reference to a snapshot in the Terra Data Repo"
      tags:
        - snapshots
      summary: Get a snapshot
      operationId: getDataRepoSnapshot
      parameters:
        - in: path
          description: The workspace namespace
          name: namespace
          required: true
          type: string
        - in: path
          description: The workspace name
          name: name
          required: true
          type: string
        - in: path
          description: The snapshot ID
          name: snapshotId
          required: true
          type: string

tags:
  - name: snapshots
    description: Data Repo snapshot API

definitions:
  DataRepoSnapshot:
    description: A Data Repo snapshot
    properties:
      snapshotId:
        type: string
        description: The ID of the snapshot in Terra Data Repo
      name:
        type: string
        description: The name of the snapshot

  DataRepoSnapshotReference:
    description: A Data Reference definition from Workspace Manager
    properties:
      referenceId:
        type: string
      name:
        type: string
      workspaceId:
        type: string
      referenceType:
        type: string
      reference:
        type: object
      cloningInstructions:
        type: string

  DataRepoSnapshotReferenceList:
    description: A list of DataRepoSnapshotReferences
    properties:
      resources:
        description: A list of Data Reference definitions from Workspace Manager
        type: array
        items:
          $ref: '#/definitions/DataRepoSnapshotReferences'
